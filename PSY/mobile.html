<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>åŒ—æŠ•å…±ç…§é›² - è¡Œå‹•ç«¯</title>
    <!-- Libraries -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        /* --- æ ¸å¿ƒæ¨£å¼ --- */
        body { 
            background-color: #f7f8fa; /* æ·ºç°èƒŒæ™¯ */
            height: 100vh; 
            display: flex; 
            flex-direction: column; 
            overflow: hidden; 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; 
        }
        
        /* --- é ‚éƒ¨å€åŸŸ --- */
        .status-bar { 
            height: 35px; background: #2c3e50; color: white; display: flex; justify-content: space-between; align-items: center; padding: 0 20px; font-size: 12px; font-weight: 500; flex-shrink: 0; 
        }
        .nav-bar { 
            height: 55px; background: #2c3e50; color: white; display: flex; align-items: center; padding: 0 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); z-index: 10; flex-shrink: 0; 
        }
        .nav-title { flex: 1; text-align: center; font-weight: bold; font-size: 16px; }
        .nav-btn { cursor: pointer; padding: 5px; font-size: 1.2rem; }

        /* --- å…§å®¹å€åŸŸ --- */
        .content { flex: 1; overflow-y: auto; position: relative; background: #fff; scroll-behavior: smooth; }
        
        /* èŠå¤©å®¤æ¨£å¼ */
        .chat-container { padding: 20px; display: flex; flex-direction: column; gap: 20px; background: #7289da1a; min-height: 100%; }
        .date-divider { text-align: center; font-size: 11px; color: #888; margin: 10px 0; background: rgba(0,0,0,0.05); padding: 2px 10px; border-radius: 10px; align-self: center; }
        .msg { max-width: 80%; padding: 12px 16px; border-radius: 20px; font-size: 14px; line-height: 1.5; position: relative; box-shadow: 0 1px 2px rgba(0,0,0,0.1); }
        .msg.ai { align-self: flex-start; background: #fff; color: #333; border-top-left-radius: 4px; margin-left: 45px; }
        .msg.ai::before { content:''; position: absolute; left: -45px; top: 0; width: 36px; height: 36px; background: url('images/avatar1.png') center/cover; border-radius: 50%; border: 2px solid #fff; box-shadow: 0 1px 3px rgba(0,0,0,0.2); }
        .msg.user { align-self: flex-end; background: #00b900; color: white; border-top-right-radius: 4px; }

        /* --- åº•éƒ¨ Rich Menu --- */
        .rich-menu { height: 70px; border-top: 1px solid #e0e0e0; display: grid; grid-template-columns: repeat(4, 1fr); background: #fcfcfc; flex-shrink: 0; padding-bottom: 5px; }
        .menu-item { display: flex; flex-direction: column; align-items: center; justify-content: center; font-size: 10px; color: #999; cursor: pointer; transition: all 0.2s; border-top: 3px solid transparent; }
        .menu-item:active { background: #f0f0f0; }
        .menu-item.active { color: #2c3e50; font-weight: bold; border-top-color: #00897b; }
        .menu-item i { font-size: 24px; margin-bottom: 4px; }

        /* --- Avatar Selection Overlay (Step 1) --- */
        #avatar-select-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); backdrop-filter: blur(5px); z-index: 100; 
            display: none; flex-direction: column; align-items: center; justify-content: center;
            animation: fadeIn 0.3s;
        }
        .avatar-opt { background: white; width: 280px; padding: 15px; margin: 10px; border-radius: 16px; display: flex; align-items: center; cursor: pointer; transition: 0.2s; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .avatar-opt:active { transform: scale(0.96); }
        .avatar-opt img { width: 55px; height: 55px; border-radius: 50%; margin-right: 15px; object-fit: cover; border: 2px solid #f0f0f0; }
        .avatar-text strong { display: block; font-size: 16px; color: #333; }
        .avatar-text small { color: #888; font-size: 12px; }

        /* --- Call Overlay (Step 2 - Video Full Screen) --- */
        #call-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 200; 
            display: none; flex-direction: column; justify-content: flex-end; align-items: center;
            padding: 20px; animation: fadeIn 0.5s ease-out; overflow: hidden;
        }
        
        /* Video Background */
        .call-video-bg {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            object-fit: cover; z-index: 0;
        }

        /* Top Info */
        .call-info {
            position: absolute; top: 40px; left: 0; width: 100%; z-index: 1;
            text-align: center; color: white; text-shadow: 0 2px 8px rgba(0,0,0,0.8);
        }

        /* Dialogue Box (Bottom) */
        .dialogue-box {
            position: relative; z-index: 1;
            background: rgba(230, 230, 230, 0.85); backdrop-filter: blur(5px);
            padding: 20px; border-radius: 20px; width: 100%; max-width: 340px;
            text-align: center; font-size: 16px; color: #222; font-weight: 500;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            margin-bottom: 20px; margin-top: auto;
        }
        .dialogue-box::after {
            content: ''; position: absolute; bottom: -10px; left: 50%; transform: translateX(-50%);
            border-width: 10px 10px 0 10px; border-style: solid;
            border-color: rgba(230, 230, 230, 0.85) transparent transparent transparent;
        }

        /* Controls */
        .call-controls { 
            position: relative; z-index: 1; display: flex; gap: 40px; margin-bottom: 30px;
        }
        .call-btn { 
            width: 65px; height: 65px; border-radius: 50%; display: flex; align-items: center; justify-content: center; 
            color: white; font-size: 26px; cursor: pointer; transition: transform 0.2s;
            box-shadow: 0 4px 10px rgba(0,0,0,0.4); border: 2px solid rgba(255,255,255,0.3);
        }
        .call-btn:active { transform: scale(0.9); }
        .btn-mic { background: rgba(0,0,0,0.5); backdrop-filter: blur(5px); }
        .btn-hangup { background: #ff4757; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

    <!-- 1. Layout -->
    <div class="status-bar"><span>09:41</span><span><i class="fas fa-wifi"></i> 100%</span></div>
    <div class="nav-bar">
        <i class="fas fa-chevron-left nav-btn" onclick="goHome()"></i>
        <div class="nav-title" id="page-title">åŒ—æŠ•å…±ç…§é›²</div>
        <i class="fas fa-bars nav-btn"></i>
    </div>

    <!-- 2. Chat Content -->
    <div class="content" id="main-content">
        <div class="chat-container">
            <div class="date-divider">ä»Šå¤© 09:30</div>
            <div class="msg ai">æ—©å®‰ï¼æˆ‘æ˜¯å°æ¨¹ ğŸŒ±<br>ä»Šå¤©åŒ—æŠ•çš„å¤©æ°£æœ‰é»æ¶¼ï¼Œå‡ºé–€è¨˜å¾—å¸¶ä»¶å¤–å¥—å–”ã€‚</div>
            <div class="msg user">æ—©å®‰ï¼Œé‚„å¯ä»¥ã€‚</div>
        </div>
    </div>

    <!-- 3. Avatar Selection (3 Characters) -->
    <div id="avatar-select-overlay">
        <h5 class="text-white mb-4 fw-bold" style="text-shadow:0 2px 4px rgba(0,0,0,0.3)">è«‹é¸æ“‡æ‚¨çš„é™ªä¼´å¤¥ä¼´</h5>
        
        <div class="avatar-opt" onclick="startCall('avatar1.png', 'å°æ¨¹', 'avatarMOV.mp4')">
            <img src="images/avatar1.png" alt="å°æ¨¹"> 
            <div class="avatar-text"><strong>å°æ¨¹</strong><small>æº«æŸ”å‚¾è½ï¼ç™‚ç™’ç³»</small></div>
            <i class="fas fa-chevron-right ms-auto text-muted"></i>
        </div>
        
        <div class="avatar-opt" onclick="startCall('avatar2.png', 'å¤§ç™½', 'avatarMOV2.mp4')">
            <img src="images/avatar2.png" alt="å¤§ç™½"> 
            <div class="avatar-text"><strong>å¤§ç™½</strong><small>ç†æ€§åˆ†æï¼å°ˆæ¥­ç³»</small></div>
            <i class="fas fa-chevron-right ms-auto text-muted"></i>
        </div>

        <div class="avatar-opt" onclick="startCall('avatar3.png', 'æš–æš–', 'avatarMOV3.mp4')">
            <img src="images/avatar3.png" alt="æš–æš–"> 
            <div class="avatar-text"><strong>æš–æš–</strong><small>é–‹å¿ƒæœï¼æ´»æ½‘ç³»</small></div>
            <i class="fas fa-chevron-right ms-auto text-muted"></i>
        </div>
        
        <button class="btn btn-light mt-4 rounded-pill px-5 fw-bold shadow-sm" onclick="closeSelect()">å–æ¶ˆ</button>
    </div>

    <!-- 4. Video Call Interface -->
    <div id="call-overlay">
        <!-- Video Background (Dynamic Source) -->
        <video id="call-video" class="call-video-bg" loop muted playsinline>
            <source src="" type="video/mp4"> <!-- Source set by JS -->
            æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´ Video æ¨™ç±¤ã€‚
        </video>

        <div class="call-info">
            <h3 class="fw-bold mb-1" id="call-name">å°æ¨¹ AI</h3>
            <p class="small opacity-75" id="call-status">æ­£åœ¨å»ºç«‹é€£ç·š...</p>
        </div>
        
        <div class="dialogue-box fade-in" id="dialogue-box" style="opacity:0">
            "å“ˆå›‰ï¼æˆ‘æ˜¯å°æ¨¹ï¼Œå¾ˆé«˜èˆˆè¦‹åˆ°ä½ ã€‚<br>ä»Šå¤©å¿ƒæƒ…å¦‚ä½•å‘¢ï¼Ÿ"
        </div>
        
        <div class="call-controls">
            <div class="call-btn btn-mic" onclick="toggleMic(this)"><i class="fas fa-microphone-slash"></i></div>
            <div class="call-btn btn-hangup" onclick="endCall()"><i class="fas fa-phone-slash"></i></div>
        </div>
    </div>

    <!-- 5. Footer -->
    <div class="rich-menu">
        <div class="menu-item active" onclick="goHome()"><i class="fas fa-comment-dots"></i>èŠå¤©</div>
        <div class="menu-item" onclick="alert('é€²å…¥å¥åº·å­˜æ‘º...')"><i class="fas fa-heartbeat text-danger"></i>å¥åº·</div>
        <div class="menu-item" onclick="openSelect()"><i class="fas fa-robot text-primary"></i>é™ªä¼´</div>
        <div class="menu-item" onclick="alert('é€²å…¥å€‹äººä¸­å¿ƒ...')"><i class="fas fa-user"></i>å€‹äºº</div>
    </div>

    <script>
        function goHome() {
            document.getElementById('main-content').innerHTML = `
                <div class="chat-container">
                    <div class="date-divider">ä»Šå¤© 09:30</div>
                    <div class="msg ai">æ—©å®‰ï¼æˆ‘æ˜¯å°æ¨¹ ğŸŒ±<br>ä»Šå¤©è¨˜å¾—é‡è¡€å£“å–”ã€‚</div>
                    <div class="msg user">æ—©å®‰ï¼Œé‚„å¯ä»¥ã€‚</div>
                </div>`;
            document.getElementById('page-title').innerText = "åŒ—æŠ•å…±ç…§é›²";
        }

        function openSelect() { document.getElementById('avatar-select-overlay').style.display = 'flex'; }
        function closeSelect() { document.getElementById('avatar-select-overlay').style.display = 'none'; }

        // Start Call Logic (With Video Swap)
        function startCall(img, name, videoFile) {
            closeSelect();
            
            // Set Name & Video Source
            document.getElementById('call-name').innerText = name + ' AI';
            const video = document.getElementById('call-video');
            video.src = "images/" + videoFile; // Dynamic video path
            
            const status = document.getElementById('call-status');
            const dialogue = document.getElementById('dialogue-box');
            
            // Play Video
            if(video) {
                video.load();
                video.play().catch(e => console.log('Auto-play blocked:', e));
            }

            // Show UI
            const overlay = document.getElementById('call-overlay');
            overlay.style.display = 'flex';
            
            // Sim Connection
            status.innerText = "é€£ç·šä¸­...";
            dialogue.style.opacity = '0';
            
            setTimeout(() => {
                status.innerText = "é€šè©±ä¸­ 00:01";
                dialogue.style.opacity = '1'; 
                dialogue.innerHTML = `å“ˆå›‰ï¼æˆ‘æ˜¯${name}ï¼Œå¾ˆé«˜èˆˆè¦‹åˆ°ä½ ã€‚<br>ä»Šå¤©å¿ƒæƒ…å¦‚ä½•å‘¢ï¼Ÿ`;
            }, 1500);
        }

        function endCall() {
            document.getElementById('call-overlay').style.display = 'none';
            const video = document.getElementById('call-video');
            if(video) video.pause();
        }

        function toggleMic(btn) {
            const icon = btn.querySelector('i');
            if(icon.classList.contains('fa-microphone-slash')) {
                icon.classList.remove('fa-microphone-slash');
                icon.classList.add('fa-microphone');
                btn.style.background = "rgba(0, 185, 0, 0.6)";
            } else {
                icon.classList.remove('fa-microphone');
                icon.classList.add('fa-microphone-slash');
                btn.style.background = "rgba(0,0,0,0.5)";
            }
        }
    </script>
</body>
</html>