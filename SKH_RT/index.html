<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>放射腫瘤科營運績效戰情室</title>
    <link rel="icon" href="image/feticon.ico" type="image/x-icon">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- FontAwesome 6 (Icons) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        /* Custom Scrollbar */
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* Animations */
        .fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        body { font-family: 'Microsoft JhengHei', 'Segoe UI', Roboto, sans-serif; background-color: #f8fafc; }
        
        .data-table th { @apply bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider py-3 px-4; }
        .data-table td { @apply whitespace-nowrap text-sm text-gray-700 py-3 px-4 border-b border-gray-100; }
        .data-table tr:hover { @apply bg-gray-50; }
        
        /* Tab Active State */
        .tab-active { @apply border-cyan-600 text-cyan-700 bg-cyan-50; }
        .tab-inactive { @apply border-transparent text-gray-500 hover:text-gray-700 hover:bg-gray-50; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;

        // --- Data Generators (Enhanced) ---
        const generateChartData = (range) => {
            if (range === 'daily') {
                const hours = Array.from({length: 10}, (_, i) => `${i+8}:00`);
                return {
                    labels: hours,
                    datasets: [
                        { label: '即時營收 (萬)', data: hours.map(() => Math.random() * 5 + 2), color: '#0891b2', type: 'line' },
                        { label: '治療人次', data: hours.map(() => Math.floor(Math.random() * 8) + 2), color: '#f59e0b', type: 'bar', yAxisID: 'y1' }
                    ]
                };
            } else if (range === 'monthly') {
                const days = Array.from({length: 30}, (_, i) => `${i+1}日`);
                return {
                    labels: days,
                    datasets: [
                        { label: '每日營收 (萬)', data: days.map(() => Math.random() * 15 + 10), color: '#0891b2', type: 'bar' },
                        { label: '目標達成線', data: days.map(() => 20), color: '#ef4444', type: 'line', borderDash: [5,5] }
                    ]
                };
            } else {
                const months = ['1月','2月','3月','4月','5月','6月','7月','8月','9月','10月','11月','12月'];
                return {
                    labels: months,
                    datasets: [
                        { label: '2023 營收 (千萬)', data: months.map(() => Math.random() * 2 + 5), color: '#0891b2', type: 'bar' },
                        { label: '2022 同期 (千萬)', data: months.map(() => Math.random() * 2 + 4), color: '#94a3b8', type: 'line' }
                    ]
                };
            }
        };

        const getKpiData = (range) => {
            if (range === 'daily') {
                return [
                    { title: "今日門診收入", value: "NT$ 185,400", sub: "+12% 較昨日", trend: "up", icon: "fa-sack-dollar", color: "bg-cyan-600" },
                    { title: "今日治療人次", value: "42 人", sub: "98% 預約出席", trend: "up", icon: "fa-user-group", color: "bg-blue-500" },
                    { title: "健保申報點數", value: "24.5 萬", sub: "進度正常", trend: "up", icon: "fa-file-invoice-dollar", color: "bg-indigo-500" },
                    { title: "儀器平均妥善率", value: "99.2%", sub: "Elekta 運轉中", trend: "up", icon: "fa-microchip", color: "bg-emerald-500" }
                ];
            } else if (range === 'monthly') {
                return [
                    { title: "本月累計營收", value: "NT$ 5,240 萬", sub: "+5.4% 較上月", trend: "up", icon: "fa-chart-column", color: "bg-cyan-600" },
                    { title: "本月治療總人次", value: "1,205 人次", sub: "-2% 較上月", trend: "down", icon: "fa-users", color: "bg-blue-500" },
                    { title: "自費療程佔比", value: "35.8%", sub: "+3% SBRT成長", trend: "up", icon: "fa-percent", color: "bg-indigo-500" },
                    { title: "設備總用電量", value: "4,500 kWh", sub: "成本 NT$ 1.8萬", trend: "down", icon: "fa-bolt", color: "bg-yellow-500" }
                ];
            } else {
                return [
                    { title: "年度總營收", value: "NT$ 6.8 億", sub: "+8.5% YoY", trend: "up", icon: "fa-trophy", color: "bg-cyan-600" },
                    { title: "年度新病患數", value: "850 人", sub: "+120 人 YoY", trend: "up", icon: "fa-user-plus", color: "bg-blue-500" },
                    { title: "年度平均點值", value: "0.91", sub: "較去年 -0.02", trend: "down", icon: "fa-coins", color: "bg-orange-500" },
                    { title: "重大維修次數", value: "3 次", sub: "停機 < 24hr", trend: "up", icon: "fa-screwdriver-wrench", color: "bg-slate-500" }
                ];
            }
        };

        // --- Components ---

        // 1. Menu
        const MenuItem = ({ item, level = 0, onSelect, currentView }) => {
            const [isOpen, setIsOpen] = useState(level < 2);
            const hasChildren = item.children && item.children.length > 0;
            const isActive = item.view === currentView;

            const handleClick = (e) => {
                e.stopPropagation();
                if (hasChildren) setIsOpen(!isOpen);
                else if (item.view) onSelect(item.view);
            };

            return (
                <div className="text-sm select-none">
                    <div 
                        className={`flex items-center py-3 px-4 cursor-pointer transition-all duration-200 border-l-4
                            ${isActive ? 'bg-cyan-50 border-cyan-600 text-cyan-700 font-bold' : 'border-transparent hover:bg-gray-50 text-gray-600'}`}
                        style={{ paddingLeft: `${level * 16 + 20}px` }}
                        onClick={handleClick}
                    >
                        <div className={`w-5 flex justify-center mr-3 ${isActive ? 'text-cyan-600' : 'text-gray-400'}`}>
                            <i className={`fa-solid ${item.icon} text-sm`}></i>
                        </div>
                        <span className="flex-1 truncate">{item.title}</span>
                        {hasChildren && (
                            <i className={`fa-solid fa-chevron-down text-[10px] transition-transform duration-200 text-gray-400 ${isOpen ? 'transform rotate-180' : ''}`}></i>
                        )}
                    </div>
                    {hasChildren && isOpen && (
                        <div className="border-l border-gray-100 ml-6">
                            {item.children.map((child, idx) => (
                                <MenuItem key={idx} item={child} level={level + 1} onSelect={onSelect} currentView={currentView} />
                            ))}
                        </div>
                    )}
                </div>
            );
        };

        // 2. Generic Chart Component
        const DynamicChart = ({ range, title }) => {
            const canvasRef = useRef(null);
            const chartRef = useRef(null);

            useEffect(() => {
                if (!canvasRef.current) return;
                const ctx = canvasRef.current.getContext('2d');
                const data = generateChartData(range);
                
                if (chartRef.current) chartRef.current.destroy();

                chartRef.current = new Chart(ctx, {
                    type: 'bar', // Default base type
                    data: {
                        labels: data.labels,
                        datasets: data.datasets.map(ds => ({
                            label: ds.label,
                            data: ds.data,
                            borderColor: ds.color,
                            backgroundColor: ds.type === 'line' ? 'transparent' : `${ds.color}80`, // Add opacity for bars
                            type: ds.type,
                            borderWidth: 2,
                            tension: 0.3,
                            yAxisID: ds.yAxisID || 'y',
                            pointRadius: 3
                        }))
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        interaction: { mode: 'index', intersect: false },
                        plugins: { legend: { position: 'top', align: 'end', labels: { usePointStyle: true, boxWidth: 6 } } },
                        scales: { 
                            y: { beginAtZero: true, grid: { borderDash: [2, 4] }, title: { display: true, text: '營收金額' } },
                            y1: { display: range === 'daily', position: 'right', grid: { display: false }, title: { display: true, text: '人次' } },
                            x: { grid: { display: false } }
                        }
                    }
                });
                return () => { if (chartRef.current) chartRef.current.destroy(); };
            }, [range]);

            return (
                <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-100 h-80 flex flex-col">
                    <h3 className="text-gray-700 font-bold mb-4 flex items-center gap-2"><i className="fa-solid fa-chart-line text-cyan-600"></i> {title}</h3>
                    <div className="flex-1 relative"><canvas ref={canvasRef}></canvas></div>
                </div>
            );
        };

        // 3. Doughnut Chart for Technique Breakdown
        const TechniqueChart = ({ range }) => {
             const canvasRef = useRef(null);
             const chartRef = useRef(null);

             useEffect(() => {
                const ctx = canvasRef.current.getContext('2d');
                if (chartRef.current) chartRef.current.destroy();
                
                // Data changes slightly based on range
                const data = range === 'daily' ? [10, 5, 15, 2] : [350, 120, 400, 80];

                chartRef.current = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['VMAT (弧形)', 'IMRT (強度調控)', '3D-CRT', 'SBRT/SRS (立體定位)'],
                        datasets: [{
                            data: data,
                            backgroundColor: ['#0891b2', '#22d3ee', '#94a3b8', '#f59e0b'],
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { position: 'right', labels: { usePointStyle: true, boxWidth: 8, font: {size: 11} } } },
                        cutout: '65%'
                    }
                });
            }, [range]);

            return (
                <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-100 h-64 flex flex-col">
                    <h3 className="text-gray-700 font-bold mb-2 text-sm">治療技術分佈 ({range === 'daily' ? '今日' : range === 'monthly' ? '本月' : '年度'})</h3>
                    <div className="flex-1 relative"><canvas ref={canvasRef}></canvas></div>
                </div>
            );
        };

        // 4. Dashboard View with Time Range Logic
        const DashboardView = () => {
            const [timeRange, setTimeRange] = useState('daily'); // daily, monthly, yearly
            const kpis = getKpiData(timeRange);

            return (
                <div className="space-y-6 fade-in">
                    {/* Range Selector Tabs */}
                    <div className="flex border-b border-gray-200 mb-4">
                        <button 
                            onClick={() => setTimeRange('daily')}
                            className={`px-6 py-3 text-sm font-bold border-b-2 transition-colors flex items-center gap-2 ${timeRange === 'daily' ? 'tab-active' : 'tab-inactive'}`}
                        >
                            <i className="fa-solid fa-clock"></i> 今日即時
                        </button>
                        <button 
                            onClick={() => setTimeRange('monthly')}
                            className={`px-6 py-3 text-sm font-bold border-b-2 transition-colors flex items-center gap-2 ${timeRange === 'monthly' ? 'tab-active' : 'tab-inactive'}`}
                        >
                            <i className="fa-solid fa-calendar-days"></i> 月度分析
                        </button>
                        <button 
                            onClick={() => setTimeRange('yearly')}
                            className={`px-6 py-3 text-sm font-bold border-b-2 transition-colors flex items-center gap-2 ${timeRange === 'yearly' ? 'tab-active' : 'tab-inactive'}`}
                        >
                            <i className="fa-solid fa-chart-pie"></i> 年度報表
                        </button>
                    </div>

                    {/* KPI Row */}
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        {kpis.map((k, i) => (
                            <div key={i} className="bg-white p-5 rounded-xl shadow-sm border border-gray-100 flex justify-between items-start hover:shadow-md transition">
                                <div>
                                    <p className="text-gray-500 text-xs font-bold uppercase">{k.title}</p>
                                    <h4 className="text-2xl font-bold text-gray-800 mt-1">{k.value}</h4>
                                    <p className={`text-xs mt-2 font-bold ${k.trend === 'up' ? 'text-green-500' : 'text-red-500'}`}>
                                        <i className={`fa-solid fa-arrow-${k.trend}`}></i> {k.sub}
                                    </p>
                                </div>
                                <div className={`p-3 bg-opacity-10 text-opacity-90 rounded-lg ${k.color.replace('bg-', 'text-')} ${k.color.replace('bg-', 'bg-')}`}>
                                    <i className={`fa-solid ${k.icon} text-xl`}></i>
                                </div>
                            </div>
                        ))}
                    </div>
                    
                    {/* Main Charts Area */}
                    <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        {/* Large Main Chart */}
                        <div className="lg:col-span-2">
                            <DynamicChart range={timeRange} title={
                                timeRange === 'daily' ? "今日營收與人流時序圖" :
                                timeRange === 'monthly' ? "本月營收目標達成分析" :
                                "年度營收成長趨勢 (YoY)"
                            } />
                        </div>

                        {/* Right Column Widgets */}
                        <div className="space-y-6">
                            {/* Technique Distribution */}
                            <TechniqueChart range={timeRange} />

                            {/* Equipment Load / Top Referrals based on view */}
                            <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex flex-col h-64 overflow-hidden">
                                <h3 className="text-gray-700 font-bold mb-4 text-sm flex items-center gap-2">
                                    <i className={`fa-solid ${timeRange === 'daily' ? 'fa-server' : 'fa-user-nurse'} text-cyan-600`}></i> 
                                    {timeRange === 'daily' ? '設備負載即時監控' : '主要病患來源'}
                                </h3>
                                <div className="flex-1 overflow-y-auto space-y-4">
                                    {timeRange === 'daily' ? (
                                        // Daily: Equipment Status
                                        [
                                            { name: 'Elekta Versa HD', load: 85, status: '運轉中', color: 'bg-green-500' },
                                            { name: 'Varian TrueBeam', load: 60, status: '待機中', color: 'bg-yellow-500' },
                                            { name: 'CT-Sim', load: 45, status: '排程空檔', color: 'bg-blue-500' }
                                        ].map((m, i) => (
                                            <div key={i}>
                                                <div className="flex justify-between text-sm mb-1">
                                                    <span className="font-medium text-gray-700">{m.name}</span>
                                                    <span className="text-xs text-gray-500">{m.status} ({m.load}%)</span>
                                                </div>
                                                <div className="w-full bg-gray-100 rounded-full h-2">
                                                    <div className={`${m.color} h-2 rounded-full`} style={{width: `${m.load}%`}}></div>
                                                </div>
                                            </div>
                                        ))
                                    ) : (
                                        // Monthly/Yearly: Referral Sources
                                        [
                                            { name: '血液腫瘤科', count: 145, pct: 45 },
                                            { name: '胸腔外科', count: 82, pct: 25 },
                                            { name: '耳鼻喉科', count: 48, pct: 15 },
                                            { name: '直腸外科', count: 32, pct: 10 },
                                        ].map((d, i) => (
                                            <div key={i} className="flex items-center justify-between border-b border-gray-50 pb-2 last:border-0">
                                                <div className="flex items-center gap-2">
                                                    <div className="w-6 h-6 rounded bg-gray-100 text-gray-500 text-xs flex items-center justify-center font-bold">{i+1}</div>
                                                    <span className="text-sm text-gray-700">{d.name}</span>
                                                </div>
                                                <div className="text-right">
                                                    <span className="block text-sm font-bold text-gray-800">{d.count} 人</span>
                                                    <span className="text-xs text-gray-400">{d.pct}%</span>
                                                </div>
                                            </div>
                                        ))
                                    )}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // 5. Other Views (Financial, Cost, Equipment) - Kept as provided previously but condensed for brevity in this file
        // (In a real scenario, these would be separate files, but here we include them to make index.html complete)
        
        const FinancialView = ({ type }) => {
             // ... (Simplified version of previous FinancialView logic for demo)
             return (
                <div className="bg-white rounded-xl shadow-sm border border-gray-100 p-8 fade-in min-h-[500px]">
                    <h2 className="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2"><i className="fa-solid fa-file-invoice text-cyan-600"></i> {type} 報表細項</h2>
                    <p className="text-gray-500">模擬資料：此處顯示財務詳細列表，包含健保代碼、病歷號、金額等。</p>
                    <div className="mt-8 p-4 bg-yellow-50 border border-yellow-100 rounded text-yellow-800 text-sm">
                        <i className="fa-solid fa-triangle-exclamation mr-2"></i> 
                        為確保隱私，此預覽畫面僅顯示去識別化數據。
                    </div>
                </div>
             );
        };

        const CostView = ({ type }) => {
            // ... (Reusing previous TDABC logic roughly)
            const data = [
                { role: '主治醫師', time: 25, cost: 2000 },
                { role: '醫學物理師', time: 40, cost: 1800 },
                { role: '放射師', time: 15, cost: 525 }
            ];
            return (
                <div className="bg-white p-8 rounded-xl shadow-sm border border-gray-100 fade-in">
                     <h2 className="text-xl font-bold text-gray-800 mb-6">TDABC 成本分析 ({type === 'energy_daily' ? '能源' : '人員'})</h2>
                     {type !== 'energy_daily' && (
                        <table className="w-full text-left">
                            <thead><tr className="border-b"><th className="pb-2">職類</th><th className="pb-2 text-right">時間(分)</th><th className="pb-2 text-right">成本</th></tr></thead>
                            <tbody>
                                {data.map((r, i) => (
                                    <tr key={i} className="border-b border-gray-50"><td className="py-3">{r.role}</td><td className="text-right font-mono">{r.time}</td><td className="text-right font-mono text-cyan-700 font-bold">${r.cost}</td></tr>
                                ))}
                            </tbody>
                        </table>
                     )}
                     {type === 'energy_daily' && <div className="h-64 bg-gray-50 flex items-center justify-center text-gray-400">能源消耗趨勢圖表區域</div>}
                </div>
            );
        };

        const EquipmentView = ({ device }) => {
             const info = device === 'elekta' 
                ? { name: 'Elekta Versa HD', img: 'image/elekta.jpg', status: '運轉中', uptime: '99.8%' }
                : { name: device, img: null, status: '待機', uptime: '95%' };

             return (
                <div className="space-y-6 fade-in">
                    <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex flex-col md:flex-row gap-6">
                         <div className="w-full md:w-1/3 h-56 bg-gray-100 rounded relative flex items-center justify-center overflow-hidden">
                             <img src={info.img} alt={info.name} className="w-full h-full object-cover" onError={(e)=>{e.target.style.display='none';e.target.nextSibling.style.display='flex'}} />
                             <div className="hidden flex-col items-center text-gray-400"><i className="fa-solid fa-image text-3xl mb-2"></i><span>{info.name}</span></div>
                         </div>
                         <div className="flex-1">
                             <h2 className="text-2xl font-bold text-gray-800 mb-2">{info.name}</h2>
                             <div className="flex gap-2 mb-4"><span className="px-2 py-1 bg-green-100 text-green-700 text-xs rounded font-bold">{info.status}</span></div>
                             <div className="grid grid-cols-2 gap-4">
                                 <div className="p-3 bg-gray-50 rounded"><div className="text-xs text-gray-500">妥善率</div><div className="text-lg font-bold">{info.uptime}</div></div>
                                 <div className="p-3 bg-gray-50 rounded"><div className="text-xs text-gray-500">今日排程</div><div className="text-lg font-bold">28 人</div></div>
                             </div>
                         </div>
                    </div>
                </div>
             );
        };

        // 6. App Container
        const App = () => {
            const [currentView, setCurrentView] = useState('dashboard');

            const menuData = [
                { title: "總覽 Dashboard", icon: "fa-table-columns", view: "dashboard" },
                { 
                    title: "營運績效管理", 
                    icon: "fa-chart-pie",
                    children: [
                        { 
                            title: "財務分析", 
                            icon: "fa-file-invoice-dollar",
                            children: [
                                { title: "健保點值收入", icon: "fa-hospital-user", children: [{ title: "每日趨勢", icon: "fa-chart-line", view: "nhi_trend" }, { title: "申報狀態", icon: "fa-list-check", view: "nhi_status" }]},
                                { title: "自費療程收入", icon: "fa-star-of-life", children: [{ title: "VMAT 營收", icon: "fa-bullseye", view: "self_vmat" }, { title: "SBRT/SRS", icon: "fa-crosshairs", view: "self_sbrt" }]},
                                { title: "每日門診收入", icon: "fa-cash-register", children: [{ title: "掛號費", icon: "fa-ticket", view: "daily_reg" }, { title: "部分負擔", icon: "fa-coins", view: "daily_part" }]}
                            ]
                        },
                        { 
                            title: "成本控制", 
                            icon: "fa-scale-balanced",
                            children: [
                                { title: "人員成本 (TDABC)", icon: "fa-users-gear", children: [{ title: "主治醫師", icon: "fa-user-doctor", view: "cost_personnel_doc" }, { title: "醫學物理師", icon: "fa-atom", view: "cost_personnel_phy" }]},
                                { title: "能源消耗", icon: "fa-plug-circle-bolt", children: [{ title: "電力日報", icon: "fa-bolt", view: "energy_daily" }]}
                            ]
                        }
                    ]
                },
                {
                    title: "放射設備管理",
                    icon: "fa-x-ray",
                    children: [
                        { title: "Elekta Versa HD", icon: "fa-circle-radiation", children: [{ title: "妥善率與狀態", icon: "fa-heart-pulse", view: "elekta_status" }, { title: "維修紀錄", icon: "fa-screwdriver-wrench", view: "elekta_status" }] },
                        { title: "Varian TrueBeam", icon: "fa-dharmachakra", view: "varian_status" },
                        { title: "CT-Sim 模擬定位", icon: "fa-ring", view: "ct_status" }
                    ]
                },
                { title: "系統設定", icon: "fa-gear", view: "settings" }
            ];

            const renderContent = () => {
                if (currentView === 'dashboard') return <DashboardView />;
                if (['nhi_trend', 'nhi_status', 'self_vmat', 'self_sbrt', 'daily_reg', 'daily_part'].includes(currentView)) return <FinancialView type={currentView} />;
                if (currentView.startsWith('cost_') || currentView === 'energy_daily') return <CostView type={currentView} />;
                if (currentView.startsWith('elekta')) return <EquipmentView device="elekta" />;
                if (currentView.startsWith('varian')) return <EquipmentView device="Varian TrueBeam" />;
                if (currentView.startsWith('ct')) return <EquipmentView device="CT-Sim" />;
                return <div className="flex items-center justify-center h-full text-gray-400">開發中...</div>;
            };

            return (
                <div className="flex h-screen overflow-hidden text-gray-800">
                    <aside className="w-72 bg-white border-r border-gray-200 flex flex-col z-20 shadow-[4px_0_24px_rgba(0,0,0,0.02)]">
                        <div className="h-16 flex items-center px-6 border-b border-gray-100 bg-white cursor-pointer" onClick={() => setCurrentView('dashboard')}>
                            <img src="image/fetlogo.png" alt="FET" className="h-8 w-auto object-contain" onError={(e) => {e.target.style.display='none'; e.target.nextSibling.style.display='flex'}} />
                            <div className="hidden font-black text-red-600 text-xl tracking-tighter">FET</div>
                            <span className="font-bold text-gray-700 text-sm tracking-wide ml-2">放射腫瘤戰情室</span>
                        </div>
                        <div className="flex-1 overflow-y-auto scrollbar-hide py-4">
                            {menuData.map((item, idx) => <MenuItem key={idx} item={item} onSelect={setCurrentView} currentView={currentView} />)}
                        </div>
                        <div className="p-4 border-t border-gray-100 bg-gray-50 flex items-center gap-3">
                            <div className="w-9 h-9 rounded-full bg-cyan-600 flex items-center justify-center text-white text-xs font-bold">DR</div>
                            <div><p className="text-xs font-bold text-gray-700">Dr. Chen</p><p className="text-[10px] text-gray-500">主任醫師 | 管理員</p></div>
                        </div>
                    </aside>

                    <main className="flex-1 flex flex-col h-screen overflow-hidden bg-slate-50">
                        <header className="h-16 bg-white border-b border-gray-200 flex items-center justify-between px-8 shadow-sm shrink-0">
                            <h2 className="text-lg font-bold text-gray-700">{currentView === 'dashboard' ? '營運總覽 Dashboard' : '詳細資料視圖'}</h2>
                            <div className="flex items-center gap-4">
                                <span className="text-xs bg-green-50 text-green-700 px-3 py-1 rounded-full border border-green-100 flex items-center gap-2"><span className="w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse"></span>HIS 連線正常</span>
                                <div className="h-8 w-px bg-gray-200"></div>
                                <p className="text-xs text-gray-500 font-mono">{new Date().toLocaleDateString()}</p>
                            </div>
                        </header>
                        <div className="flex-1 overflow-y-auto p-8">{renderContent()}</div>
                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>