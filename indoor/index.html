<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>å°åŒ—æ¦®ç¸½ é™¢å€å°èˆª</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        /* å…¨å±€ä½ˆå±€ */
        body { margin: 0; display: flex; height: 100vh; font-family: "Microsoft JhengHei", sans-serif; overflow: hidden; }
        
        /* å´é‚Šè³‡è¨Šæ¬„ */
        #sidebar { width: 360px; background: #f4f7f6; border-right: 1px solid #ddd; display: flex; flex-direction: column; z-index: 20; }
       .search-area { padding: 20px; background: #0056b3; color: white; }
        #search-input { width: 70%; padding: 10px; border: none; border-radius: 4px; }
        #voice-btn { width: 20%; padding: 10px; background: #ff9f43; border: none; cursor: pointer; border-radius: 4px; }
        
        #results-list { flex: 1; overflow-y: auto; padding: 10px; }
       .result-card { background: white; padding: 15px; margin-bottom: 10px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); cursor: pointer; transition: 0.2s; }
       .result-card:hover { background: #e1f5fe; }
       .tag { display: inline-block; padding: 3px 8px; font-size: 12px; border-radius: 10px; margin-right: 5px; }
       .tag-surg { background: #ffcccc; color: #d63031; } /* æ‰‹è¡“ç´…è‰² */
       .tag-opd { background: #cce5ff; color: #0984e3; } /* é–€è¨ºè—è‰² */

        /* åœ°åœ–å€åŸŸ */
        #map { flex: 1; background: #eef2f3; position: relative; }
        
        /* æ¨“å±¤åˆ‡æ›å™¨ UI */
       .floor-switcher { position: absolute; right: 20px; top: 20px; background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.2); z-index: 1000; display: flex; flex-direction: column; overflow: hidden; }
       .floor-btn { padding: 10px 15px; border: none; background: white; cursor: pointer; border-bottom: 1px solid #eee; font-weight: bold; }
       .floor-btn:hover,.floor-btn.active { background: #0056b3; color: white; }

        /* äº’å‹•æ¨£å¼ */
       .highlight-room { fill: #ff7675!important; fill-opacity: 0.8; stroke: #d63031; stroke-width: 3px; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { fill-opacity: 0.4; } 50% { fill-opacity: 0.9; } 100% { fill-opacity: 0.4; } }
    </style>
</head>
<body>

    <div id="sidebar">
        <div class="search-area">
            <h2>ğŸ¥ æ¦®ç¸½å°èˆª</h2>
            <div style="display:flex; justify-content:space-between;">
                <input type="text" id="search-input" placeholder="è¼¸å…¥ç§‘åˆ¥ (å¦‚: çš®è†šç§‘)...">
                <button id="voice-btn" onclick="startVoice()">ğŸ¤</button>
            </div>
        </div>
        <div id="results-list">
            <div class="result-card" onclick="locate('dentistry-opd')">
                <h3>ğŸ¦· ç‰™ç§‘ (ä¸€èˆ¬é–€è¨º)</h3>
                <p><span class="tag tag-opd">é–€è¨º</span> ç¬¬äºŒé–€è¨ºå¤§æ¨“ 7F</p>
            </div>
            <div class="result-card" onclick="locate('dentistry-surg')">
                <h3>ğŸ’‰ ç‰™ç§‘ (å£è…”å¤–ç§‘æ‰‹è¡“)</h3>
                <p><span class="tag tag-surg">æ‰‹è¡“</span> æ€æºæ¨“ 3F</p>
            </div>
        </div>
    </div>

    <div id="map">
        <div class="floor-switcher">
            <button class="floor-btn" onclick="changeFloor('21F')">21F</button>
            <button class="floor-btn" onclick="changeFloor('7F')">7F</button>
            <button class="floor-btn active" onclick="changeFloor('1F')">1F</button>
            <button class="floor-btn" onclick="changeFloor('B1')">B1</button>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
        // 1. åˆå§‹åŒ–åœ°åœ–
        var map = L.map('map', {
            crs: L.CRS.Simple,
            minZoom: -2,
            maxZoom: 2,
            zoomControl: false
        });

        // å®šç¾©è™›æ“¬é‚Šç•Œ
        var bounds = [, ];
        
        // 2. æ¨“å±¤è³‡æ–™åº« (æ¨¡æ“¬)
        var floors = {
            '1F': 'maps/tvgh-1f.svg',
            '7F': 'maps/tvgh-7f.svg',
            '21F': 'maps/tvgh-21f.svg'
        };
        
        var currentOverlay = L.imageOverlay(floors['1F'], bounds).addTo(map);
        map.fitBounds(bounds);

        // 3. åˆ‡æ›æ¨“å±¤é‚è¼¯
        function changeFloor(floor) {
            map.removeLayer(currentOverlay);
            // å¯¦éš›æ‡‰ç”¨ä¸­éœ€æª¢æŸ¥åœ–ç‰‡æ˜¯å¦å­˜åœ¨
            currentOverlay = L.imageOverlay(floors[floor] |

| floors['1F'], bounds).addTo(map);
            
            // æ›´æ–°æŒ‰éˆ•æ¨£å¼
            document.querySelectorAll('.floor-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }

        // 4. èªéŸ³è­˜åˆ¥é‚è¼¯
        function startVoice() {
            var SpeechRecognition = window.SpeechRecognition |

| window.webkitSpeechRecognition;
            if (!SpeechRecognition) return alert("ä¸æ”¯æ´èªéŸ³");
            
            var recognition = new SpeechRecognition();
            recognition.lang = 'zh-TW';
            recognition.start();
            
            recognition.onresult = function(e) {
                var text = e.results.transcript;
                document.getElementById('search-input').value = text;
                // æ¨¡æ“¬æœå°‹
                alert("æ­£åœ¨æœå°‹: " + text);
            }
        }
        
        // 5. å®šä½é‚è¼¯
        function locate(id) {
            // å¯¦éš›æ‡‰ä½¿ç”¨ map.flyTo() ä¸¦é«˜äº® SVG å…ƒç´ 
            console.log("Locating: " + id);
            // ç¯„ä¾‹ï¼šè‹¥é¸ç‰™ç§‘é–€è¨ºï¼Œè‡ªå‹•åˆ‡æ›åˆ° 7F
            if(id === 'dentistry-opd') {
                changeFloor('7F'); // æ¨¡æ“¬åˆ‡æ›
                // ä¸¦é«˜äº®å°æ‡‰å€åŸŸ...
            }
        }
    </script>
</body>
</html>